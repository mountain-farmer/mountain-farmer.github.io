
<!-- saved from url=(0046)https://sqlweb.fsb.miamioh.edu/enteroracle.php -->
<html><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/content/location/location.js"></script><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/libs/extend-native-history-api.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="./Database Design and Warehousing Final Project_files/style.css" rel="stylesheet">
    <script src="./Database Design and Warehousing Final Project_files/jquery.min.js"></script>
    <link href="./Database Design and Warehousing Final Project_files/calendar.css" rel="stylesheet">
    <script src="./Database Design and Warehousing Final Project_files/calendar.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script language="JavaScript">

        //addList();

        function rowRangeChange(select, noOfQry, qrytype) {
            var empPrimaryDetails, empPrimaryDetailsArry;
            var xhttp;

            //document.getElementById('displayloading').style.display = "block";
            //document.getElementById('displayloading').innerHTML="Please wait while data is loading";
            //alert (select);
            if (select == "") {
                //document.getElementById("txtHint").innerHTML = "";
                //document.getElementById("livesearch").innerHTML="";
                //document.getElementById("livesearch").style.border="0px";
                //return;
                select = "NO Match found";
                //alert (select);
            }
            //alert (select);
            // else
            // {
            if (window.XMLHttpRequest) {
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xhttp = new XMLHttpRequest();
            } else {
                // code for IE6, IE5
                xhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }

            xhttp.onreadystatechange = function () {
                if (xhttp.readyState == 4 && xhttp.status == 200) {

                    //document.getElementById("txtHint").innerHTML = xhttp.responseText;
                    empPrimaryDetails = xhttp.responseText;
                    //alert ("inside "+empPrimaryDetails);
                    //document.getElementById("txtHint").innerHTML = empPrimaryDetails;
                    //document.getElementById("displaydata"+noOfQry).style.display = "block";
                    document.getElementById("displaydata" + noOfQry).innerHTML = empPrimaryDetails;
                    // document.getElementById("displaydata"+noOfQry).style.border="5px solid #A5ACB2";
                    document.getElementById('displayloading').style.display = "none";

                }
            };
            // var selectType =  findSelection("typeselect");

            xhttp.open("GET", "getdisplaydata.php?sentfrom=" + qrytype + "&id=" + select + "&qrynum=" + noOfQry, true);
            xhttp.send();
            //}

        }

        function addList() {
            /*	//alert("Inside");
           //var label1 = document.getElementById('sqlhistory1');
           //label1.innerHTML = 'Test';//document.getElementById("sqltext").value()";
           //alert("complete");
           //$('#sqlhistory1').text("test");
           var sqltextvalue = document.getElementById("sqltext").value;
           alert (sqltextvalue);
           if (selected == "Fall")
           {
             yr = yr +1 +"10";
             document.getElementById("coursetermdiv").style.display="none";
             $('#year').val(yr);
           }
           */
        }

        function sqlquerycopy(query) {

            document.getElementById("sqltext").value = query;
        }


    </script>
    <title>FSB Oracle</title>

<script bis_use="true" type="text/javascript" charset="utf-8" data-bis-config="[&quot;facebook.com/&quot;,&quot;twitter.com/&quot;,&quot;youtube-nocookie.com/embed/&quot;,&quot;//vk.com/&quot;,&quot;//www.vk.com/&quot;,&quot;//linkedin.com/&quot;,&quot;//www.linkedin.com/&quot;,&quot;//instagram.com/&quot;,&quot;//www.instagram.com/&quot;,&quot;//www.google.com/recaptcha/api2/&quot;,&quot;//hangouts.google.com/webchat/&quot;,&quot;//www.google.com/calendar/&quot;,&quot;//www.google.com/maps/embed&quot;,&quot;spotify.com/&quot;,&quot;soundcloud.com/&quot;,&quot;//player.vimeo.com/&quot;,&quot;//disqus.com/&quot;,&quot;//tgwidget.com/&quot;,&quot;//js.driftt.com/&quot;,&quot;friends2follow.com&quot;,&quot;/widget&quot;,&quot;login&quot;,&quot;//video.bigmir.net/&quot;,&quot;blogger.com&quot;,&quot;//smartlock.google.com/&quot;,&quot;//keep.google.com/&quot;,&quot;/web.tolstoycomments.com/&quot;,&quot;moz-extension://&quot;,&quot;chrome-extension://&quot;,&quot;/auth/&quot;,&quot;//analytics.google.com/&quot;,&quot;adclarity.com&quot;,&quot;paddle.com/checkout&quot;,&quot;hcaptcha.com&quot;,&quot;recaptcha.net&quot;,&quot;2captcha.com&quot;,&quot;accounts.google.com&quot;,&quot;www.google.com/shopping/customerreviews&quot;,&quot;buy.tinypass.com&quot;,&quot;gstatic.com&quot;,&quot;secureir.ebaystatic.com&quot;,&quot;docs.google.com&quot;,&quot;contacts.google.com&quot;,&quot;github.com&quot;,&quot;mail.google.com&quot;,&quot;chat.google.com&quot;,&quot;audio.xpleer.com&quot;]" src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/executers/vi-tr.js"></script></head>
<!-- <body onload ="rowRangeChange(document.getElementById('rowrange').value,0);">-->
<body bis_register="W3sibWFzdGVyIjp0cnVlLCJleHRlbnNpb25JZCI6ImVwcGlvY2VtaG1ubGJoanBsY2drb2ZjaWllZ29tY29uIiwiYWRibG9ja2VyU3RhdHVzIjp7IkRJU1BMQVkiOiJkaXNhYmxlZCIsIkZBQ0VCT09LIjoiZGlzYWJsZWQiLCJUV0lUVEVSIjoiZGlzYWJsZWQiLCJSRURESVQiOiJkaXNhYmxlZCJ9LCJ2ZXJzaW9uIjoiMi4wLjA5Iiwic2NvcmUiOjIwMDA5fV0=">
<script language="JavaScript">

    function clearsql() {

        document.getElementById("sqltext").value = "";
              document.getElementById("enteroracle").submit();
    }


</script>

<table id="tablewithoutborder" align="center">
    <tbody><tr>
        <td>
            <div id="miamilogo" bis_skin_checked="1">
                <img src="./Database Design and Warehousing Final Project_files/miamilogo.png">
            </div>
        </td>
        <td width="10%"></td>
        <td>

            <div id="fsblogo" bis_skin_checked="1">
                <img src="./Database Design and Warehousing Final Project_files/fsb.png">
            </div>
        </td>
        <td width="10%"></td>
      <td align="right"><font color="#cccccc"><a href="https://sqlweb.fsb.miamioh.edu/logout.php"><font color="#999999">Logout</font></a>  mungenjr </font></td>    </tr>
</tbody></table>

<p>&nbsp;
</p>
<div id="mainformadmin" bis_skin_checked="1">


    <table border="0" width="100%" align="center">
        <tbody><tr>
            <td width="60%">

                <input type="file" id="fileupload" name="fileupload" style="display: none" onchange="Handlechange();">
                <input type="text" id="filename" readonly="true">
                <input type="button" value="Load Script" id="fakeBrowse" onclick="HandleBrowseClick();">
                <script>
                    function HandleBrowseClick() {
                        var fileinput = document.getElementById("fileupload");
                        fileinput.click();
                    }

                    function Handlechange() {
                        var fileinput = document.getElementById("browse");
                        var textinput = document.getElementById("filename");
                        textinput.value = fileinput.value;
                    }

                    document.getElementById('fileupload').onchange = function () {

                        var file = this.files[0];

                        var reader = new FileReader();
                        reader.onload = function (progressEvent) {
                            // Entire file
                            // console.log(this.result);
                            document.getElementById('sqltext').value = this.result;
                            // By lines
                            // var lines = this.result.split('\n');
                            // for(var line = 0; line < lines.length; line++){
                            //   console.log(lines[line]);

                            // }
                        };
                        reader.readAsText(file);
                    };
                </script>
            </td>
            <td width="30%" valign="top"></td>
        </tr>
        <form name="enteroracle" id="enteroracle" action="https://sqlweb.fsb.miamioh.edu/enteroracle.php" method="post"></form>
            <tr>
                <td width="60%">
                    <textarea name="sqltext" id="sqltext" placeholder="Enter the query..." rows="10" cols="100" style="width:100%;">-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate&gt;2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate&gt;2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating&lt; average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired&gt;0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');</textarea>
                    <br>
                    <button type="submit" name="sqlexecute" size="50%" value="Execute Query">Execute Query</button>
                    &nbsp;&nbsp;&nbsp;&nbsp;<button type="submit" name="savesql" size="50%" value="Save script">Save
                        Script
                    </button> &nbsp;&nbsp;&nbsp;&nbsp;<button type="button" name="clear" onclick="clearsql()">Clear
                    </button>
                </td>
                <td width="30%" valign="top"> Last 15 SQL statements<br>
                    <select id="sqlhistory" name="sqlhistory" onchange="sqlquerycopy(this.value)" onclick="sqlquerycopy(this.value)" style="width:100%;max-width:95%;">
                        <optgroup label="Last 15 SQL statements">
                          <option name="-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111," southern="" charm',="" '229="" cameron="" loop',="" null,="" 1000.00,="" 06,="" 6);="" insert="" into="" house="" (houseid,="" description,="" location,="" photos,="" price,="" numberofbeds,="" numberofbaths)="" values="" (112,="" 'big="" bertha',="" '481="" esther="" lane',="" 1249.99,="" 2,="" 8);="" (113,="" 'southern="" comfort',="" '10="" ski="" 900,="" 9,="" 9);="" (114,="" 'comfy="" cabin',="" '100="" drive="" 500,="" 4,="" 4);="" (115,="" 'happy="" hut',="" '614="" lake="" view="" 400,="" 3,="" 1);="" (116,="" 'hazel''s="" house',="" '914="" nut="" drive',="" 750.11,="" 6,="" 5);="" (117,="" 'pippa''s="" palace',="" popper="" 1500,="" 10,="" 12);="" (118,="" 'millie''s="" manor',="" '150="" golden="" 1300,="" (119,="" 'diamond="" dock',="" '200="" ginger="" street',="" 820,="" 5,="" (120,="" 'mickey="" mouse="" clubhouse',="" '001="" daisy="" 1000,="" 8,="" --="" inserting="" booking="" order="" data="" booking_order="" (orderid,="" datebooked,="" checkindate,="" checkoutdate,="" invoicenumber,="" houseid)="" (12345,="" '01-dec-2020',="" '20-may-2021',="" '27-may-2021',="" 54321,="" 111);="" (12346,="" '17-nov-2020',="" '4-jun-2021',="" '6-jun-2021',="" 54322,="" (12347,="" '18-jan-2021',="" '11-jun-2021',="" '13-jun-2021',="" 54323,="" 116);="" (12348,="" '3-mar-2021',="" '18-jun-2021',="" '20-jun-2021',="" 54324,="" 114);="" (12349,="" '22-oct-2020',="" '25-jun-2021',="" '27-jun-2021',="" 54325,="" 112);="" (12350,="" '14-sep-2020',="" '2-jul-2021',="" '4-jul-2021',="" 54326,="" 118);="" (12351,="" '18-feb-2021',="" '9-jul-2021',="" '11-jul-2021',="" 54327,="" (12352,="" '4-dec-2020',="" '16-jul-2021',="" '18-jul-2021',="" 54328,="" (12353,="" '19-nov-2020',="" '23-jul-2021',="" '25-jul-2021',="" 54329,="" 113);="" (12354,="" '30-jan-2021',="" '30-jul-2021',="" '2-aug-2021',="" 54330,="" appliances="" (applianceid,="" appliancetype,="" repaircost,="" datepurchased,="" timesrepaired,="" costofpurchase,="" currentlybroken,="" (56789,="" 'fridge',="" 300.00,="" '31-oct-2020',="" 1,="" 'n',="" (56790,="" 'dryer',="" 200.00,="" '12-mar-2021',="" 0,="" 900.00,="" (56791,="" 'washer',="" 250.00,="" 800.00,="" (56792,="" 'oven',="" 400.00,="" '29-jun-2019',="" (56793,="" 'toaster',="" 100.00,="" '20-aug-2017',="" (56794,="" 'microwave',="" 120.00,="" '01-sep-2018',="" (56795,="" 'freezer',="" (56796,="" 'dishwasher',="" 275.00,="" '05-oct-2020',="" (56797,="" 'coffee="" maker',="" '17-feb-2022',="" 350.00,="" (56798,="" 'blender',="" 150.00,="" (56799,="" 'mixer',="" 110.00,="" '10-feb-2022',="" 225.00,="" amenities="" (amenityid,="" (31278,="" 'private="" dock="" with="" 2="" floors="" for="" boats="" and="" lounging',="" (61429,="" 'hot="" tub',="" (76094,="" 'speaker="" system',="" (65432,="" 'beverage="" fridge',="" (78901,="" 'ice="" machine',="" (65123,="" 'outdoor="" fireplace',="" (54637,="" 'large="" grill',="" (76290,="" 'back="" patio',="" (82067,="" 'garage',="" (98075,="" 'ping-pong="" table',="" renter="" –="" (renterid,firstname,lastname,email,phonenumber,datevisited,costofcleaning,numberofguests,orderid)="" (11111,'emma',="" 'kate','emmadygert@gmail.com',6142902117,="" '20-may-2020',150,15,12345);="" (11112,="" 'hannah',="" 'bailey','hb@yahoo.com',6145675670,="" '04-jun-2021',150,10,12346);="" (11113,'lily','smith','smithle@gmail.com',6788003000,'11-jun-2021',150,13,12347);="" (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-jun-2021',150,15,12348);="" (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-jun-2021',150,12,12349);="" (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-jul-2021',150,8,12350);="" (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-jul-2021',150,14,12351);="" (11118,'david','will','davidw@gmail.com',8764520980,'06-jul-2021',150,17,12352);="" (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-jul-2021',150,13,12353);="" (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-jul-2021',150,7,12354);="" invoices="" (invoicenumber,="" total,="" tax,="" grandtotal,="" dateofbilling,="" orderid)="" (54321,="" 7150.00,="" 7250.00,="" '01-june-2021',="" 'fully="" paid',="" 12345);="" values(54322,="" 10099.00,="" 10249.00,="" 'partially="" 12346);="" values(54323,="" 12347);="" values(54324,="" 8000.00,="" 125.00,="" 8125.00,="" '01-july-2021',="" 'not="" 12348);="" values(54325,="" 11000.00,="" 11150.00,="" 12349);="" values(54326,="" 10000.00,="" 140.00,="" 10140.00,="" 12350);="" values(54327,="" 7500.00,="" 7600.00,="" '10-july-2021',="" 12351);="" values(54328,="" '20-july-2021',="" 12352);="" values(54329,="" '15-july-2021',="" 12353);="" values(54330,="" 9000.00,="" 130.00,="" 9130.00,="" 12354);="" cleaning="" maintenance="" crews="" clean_main_crews="" (crewid,="" phone,="" email,="" maintenanceprice,="" houseid,="" maintenancename)="" (11111,="" 9001239876,="" 'janice@cleaning.com',="" 75.00,="" 111="" ,'janice="" conrad');="" (22222,="" 112,="" 'janice="" (33333,="" 9009876543,="" 'builder@building.com',="" 113,="" 'bob="" builder');="" (44444,="" 114,="" (55555,="" 115="" (66666,="" 116="" (77777,="" 117="" task="" (taskid,="" taskdescription,="" applianceid,="" crewid)="" 'fridge="" deep="" clean',="" 56789,="" 22222);="" 'change="" lightbulbs',="" 56790,="" 'dishwasher="" cleaning',="" 56796,="" 11111);="" 'dryer="" repair',="" 'washer="" 56791,="" (88888,="" 'oven="" 56792,="" (99999,="" 'freezer="" 56795,="" reviews="" (reviewid,="" number_rating,="" average_rating,="" customer_name,="" date_posted,="" title_phrase,="" dateofstay,="" customer_location,="" renterid)="" values(54321,="" 4.4,="" 'emma="" kate="" dygert',="" 'beautiful="" view!',="" '30-may-2021',="" 'great',="" 'ohio',="" 'hannah="" bailey',="" 'a="" lot="" of="" fun!',="" '02-june-2021',="" 'fun',="" 'kentucky',="" 11112);="" 'lily="" smith',="" 'excellent="" experience',="" 'excellent',="" 'indiana',="" 11113);="" 'ava="" miller',="" 'could="" be="" better',="" '10-june-2021',="" 'unsatisfied',="" 11114);="" 'julian="" 'was="" a="" great="" stay',="" '28-june-2021',="" '15-june-2021',="" 'tennessee',="" 11115);="" host="" (hostname,="" phonenumber,="" email)="" values('john="" 6143238831,'john@johndygert.com');="" values('alison="" 6143234701,'alisondygert@gmail.com');="" values('emma="" 6142902117,'emmadygert@gmail.com');="" values('jackson="" 6147609422,'jacksondygert@gmail.com');="" values('hayden="" 6144301717,'haydendygert@gmail.com');="" --querying="" to="" return="" results--="" uncollected="" amount="" percentage="" select="" firstname,lastname,email,orderid,description,to_char(total,'$999,999.99')="" as="" totalamt,="" to_char(100*sum(total)="" (select="" sum(total)="" from="" invoices),'99.99')="" percentoftotalamt="" full="" join="" using="" (orderid)="" having="" description="" in="" ('not="" paid')="" group="" by="" firstname,lastname,email,orderid,="" to_char(total,'$999,999.99'),description="" to_char(total,'$999,999.99')="" desc;="" tracking="" partial="" payment="" (outer="" join)="" firstname,lastname,email,invoices.invoicenumber,="" orderid,houseid,to_char(total,'$999,999.99')="" totalamt,checkindate,checkoutdate,description="" where="" unpaid="" orders="" totalamt,checkindate,checkoutdate,(select="" to_char(sum(total),'$999,999.99')="" )="" totalunpaidamt,description="" orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description="" estimate="" revenue="" to_char(sum(total-maintenanceprice-repaircost),'$999,999.99')="" estrevenue="" ,houseid="" (houseid)="" (invoicenumber)="" houseid="" repair="" cost="" booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99')="" totalrevenue="" repaircost="" is="" not="" null="" booking_order.orderid,to_char(total,'999,999.99');="" staying="" more="" than="" days="" orderid,="" firstname,lastname,email,checkindate,checkoutdate,(select="" sum(checkoutdate-checkindate)="" checkoutdate-checkindate="">2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate&gt;2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating&lt; average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired&gt;0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');'&gt;-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate&gt;2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate&gt;2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating&lt; average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired&gt;0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');</option>                        </optgroup>
                    </select>
                </td>
            </tr>
    </tbody></table>
    
    <br>
      <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS;'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30));'</script>
  Command successfully processed<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');'</script>
  Inserted 1 row(s)<br>    <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 5 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange105" id="rowrange105" onchange="rowRangeChange(this.value,105,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange105' id='rowrange105' onchange='rowRangeChange(this.value,105,"nonload")'>-->
          <option value="1 to 5">1 to 5</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange105').val(),105, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" style="display: none;" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata105" id="displaydata105" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">FIRSTNAME</th><th align="left">LASTNAME</th><th align="left">EMAIL</th><th align="left">ORDERID</th><th align="left">DESCRIPTION</th><th align="left">TOTALAMT</th><th align="left">PERCENTOFTOTALAMT</th></tr><tr><td align="left">julian                        </td><td align="left">smith                         </td><td align="left">julian01@yahoo.com</td><td align="left">12349</td><td align="left">partially paid</td><td align="left">  $11,000.00</td><td align="left"> 12.93</td></tr><tr><td align="left">hannah                        </td><td align="left">bailey                        </td><td align="left">hb@yahoo.com</td><td align="left">12346</td><td align="left">partially paid</td><td align="left">  $10,099.00</td><td align="left"> 11.87</td></tr><tr><td align="left">ava                           </td><td align="left">miller                        </td><td align="left">avamiller1@gmail.com</td><td align="left">12348</td><td align="left">not paid</td><td align="left">   $8,000.00</td><td align="left">  9.41</td></tr><tr><td align="left">david                         </td><td align="left">will                          </td><td align="left">davidw@gmail.com</td><td align="left">12352</td><td align="left">partially paid</td><td align="left">   $8,000.00</td><td align="left">  9.41</td></tr><tr><td align="left">thomas                        </td><td align="left">train                         </td><td align="left">choochoo@yahoo.com</td><td align="left">12351</td><td align="left">not paid</td><td align="left">   $7,500.00</td><td align="left">  8.82</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 3 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange106" id="rowrange106" onchange="rowRangeChange(this.value,106,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange106' id='rowrange106' onchange='rowRangeChange(this.value,106,"nonload")'>-->
          <option value="1 to 3">1 to 3</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange106').val(),106, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata106" id="displaydata106" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">FIRSTNAME</th><th align="left">LASTNAME</th><th align="left">EMAIL</th><th align="left">INVOICENUMBER</th><th align="left">ORDERID</th><th align="left">HOUSEID</th><th align="left">TOTALAMT</th><th align="left">CHECKINDATE</th><th align="left">CHECKOUTDATE</th><th align="left">DESCRIPTION</th></tr><tr><td align="left">julian                        </td><td align="left">smith                         </td><td align="left">julian01@yahoo.com</td><td align="left">54325</td><td align="left">12349</td><td align="left">112</td><td align="left">  $11,000.00</td><td align="left">25-Jun-2021</td><td align="left">27-Jun-2021</td><td align="left">partially paid</td></tr><tr><td align="left">hannah                        </td><td align="left">bailey                        </td><td align="left">hb@yahoo.com</td><td align="left">54322</td><td align="left">12346</td><td align="left">111</td><td align="left">  $10,099.00</td><td align="left">04-Jun-2021</td><td align="left">06-Jun-2021</td><td align="left">partially paid</td></tr><tr><td align="left">david                         </td><td align="left">will                          </td><td align="left">davidw@gmail.com</td><td align="left">54328</td><td align="left">12352</td><td align="left">114</td><td align="left">   $8,000.00</td><td align="left">16-Jul-2021</td><td align="left">18-Jul-2021</td><td align="left">partially paid</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 2 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange107" id="rowrange107" onchange="rowRangeChange(this.value,107,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange107' id='rowrange107' onchange='rowRangeChange(this.value,107,"nonload")'>-->
          <option value="1 to 2">1 to 2</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange107').val(),107, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata107" id="displaydata107" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">FIRSTNAME</th><th align="left">LASTNAME</th><th align="left">EMAIL</th><th align="left">INVOICENUMBER</th><th align="left">ORDERID</th><th align="left">HOUSEID</th><th align="left">TOTALAMT</th><th align="left">CHECKINDATE</th><th align="left">CHECKOUTDATE</th><th align="left">TOTALUNPAIDAMT</th><th align="left">DESCRIPTION</th></tr><tr><td align="left">ava                           </td><td align="left">miller                        </td><td align="left">avamiller1@gmail.com</td><td align="left">54324</td><td align="left">12348</td><td align="left">114</td><td align="left">   $8,000.00</td><td align="left">18-Jun-2021</td><td align="left">20-Jun-2021</td><td align="left">  $15,500.00</td><td align="left">not paid</td></tr><tr><td align="left">thomas                        </td><td align="left">train                         </td><td align="left">choochoo@yahoo.com</td><td align="left">54327</td><td align="left">12351</td><td align="left">111</td><td align="left">   $7,500.00</td><td align="left">09-Jul-2021</td><td align="left">11-Jul-2021</td><td align="left">  $15,500.00</td><td align="left">not paid</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 1 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange108" id="rowrange108" onchange="rowRangeChange(this.value,108,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange108' id='rowrange108' onchange='rowRangeChange(this.value,108,"nonload")'>-->
          <option value="1 to 1">1 to 1</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange108').val(),108, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata108" id="displaydata108" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">ESTREVENUE</th><th align="left">HOUSEID</th></tr><tr><td align="left"> $190,357.00</td><td align="left">111</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99');'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 4 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange109" id="rowrange109" onchange="rowRangeChange(this.value,109,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange109' id='rowrange109' onchange='rowRangeChange(this.value,109,"nonload")'>-->
          <option value="1 to 4">1 to 4</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange109').val(),109, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata109" id="displaydata109" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">ORDERID</th><th align="left">REPAIRCOST</th><th align="left">TOTALREVENUE</th></tr><tr><td align="left">12346</td><td align="left">   $1,945.00</td><td align="left">  10,099.00</td></tr><tr><td align="left">12349</td><td align="left">     $310.00</td><td align="left">  11,000.00</td></tr><tr><td align="left">12351</td><td align="left">   $1,945.00</td><td align="left">   7,500.00</td></tr><tr><td align="left">12345</td><td align="left">   $1,945.00</td><td align="left">   7,150.00</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99')
   SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay From renter JOIN booking_order USING (orderid) JOIN invoices USING (orderid) where checkoutdate-checkindate>2 GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 2 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange110" id="rowrange110" onchange="rowRangeChange(this.value,110,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange110' id='rowrange110' onchange='rowRangeChange(this.value,110,"nonload")'>-->
          <option value="1 to 2">1 to 2</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange110').val(),110, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata110" id="displaydata110" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">ORDERID</th><th align="left">FIRSTNAME</th><th align="left">LASTNAME</th><th align="left">EMAIL</th><th align="left">CHECKINDATE</th><th align="left">CHECKOUTDATE</th><th align="left">TOTALDAYS</th><th align="left">DAYSSTAY</th></tr><tr><td align="left">12345</td><td align="left">emma                          </td><td align="left">kate                          </td><td align="left">emmadygert@gmail.com</td><td align="left">20-May-2021</td><td align="left">27-May-2021</td><td align="left">10</td><td align="left">7</td></tr><tr><td align="left">12354</td><td align="left">jill                          </td><td align="left">mack                          </td><td align="left">jillmack@yahoo.com</td><td align="left">30-Jul-2021</td><td align="left">02-Aug-2021</td><td align="left">10</td><td align="left">3</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99')
   SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay From renter JOIN booking_order USING (orderid) JOIN invoices USING (orderid) where checkoutdate-checkindate>2 GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate
   Select orderid,firstname,lastname,number_rating, houseid,description,email From reviews Join renter USING (renterid) JOIN Booking_order USING (orderid) WHERE number_rating< average_rating;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 1 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange111" id="rowrange111" onchange="rowRangeChange(this.value,111,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange111' id='rowrange111' onchange='rowRangeChange(this.value,111,"nonload")'>-->
          <option value="1 to 1">1 to 1</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange111').val(),111, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata111" id="displaydata111" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">ORDERID</th><th align="left">FIRSTNAME</th><th align="left">LASTNAME</th><th align="left">NUMBER_RATING</th><th align="left">HOUSEID</th><th align="left">DESCRIPTION</th><th align="left">EMAIL</th></tr><tr><td align="left">12348</td><td align="left">ava                           </td><td align="left">miller                        </td><td align="left">3</td><td align="left">114</td><td align="left">could be better</td><td align="left">avamiller1@gmail.com</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99')
   SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay From renter JOIN booking_order USING (orderid) JOIN invoices USING (orderid) where checkoutdate-checkindate>2 GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate
   Select orderid,firstname,lastname,number_rating, houseid,description,email From reviews Join renter USING (renterid) JOIN Booking_order USING (orderid) WHERE number_rating< average_rating
   Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost FROM appliances HAVING timesrepaired>0 group by houseid,applianceid,appliancetype,repaircost,timesrepaired;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 5 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange112" id="rowrange112" onchange="rowRangeChange(this.value,112,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange112' id='rowrange112' onchange='rowRangeChange(this.value,112,"nonload")'>-->
          <option value="1 to 5">1 to 5</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange112').val(),112, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata112" id="displaydata112" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">HOUSEID</th><th align="left">APPLIANCEID</th><th align="left">APPLIANCETYPE</th><th align="left">REPAIRCOST</th><th align="left">TIMESREPAIRED</th><th align="left">TOTALREPAIRCOST</th></tr><tr><td align="left">111</td><td align="left">56795</td><td align="left">Freezer</td><td align="left">300</td><td align="left">1</td><td align="left">300</td></tr><tr><td align="left">111</td><td align="left">56793</td><td align="left">toaster</td><td align="left">100</td><td align="left">2</td><td align="left">200</td></tr><tr><td align="left">111</td><td align="left">56792</td><td align="left">oven</td><td align="left">400</td><td align="left">1</td><td align="left">400</td></tr><tr><td align="left">111</td><td align="left">56789</td><td align="left">fridge</td><td align="left">300</td><td align="left">1</td><td align="left">300</td></tr><tr><td align="left">111</td><td align="left">56794</td><td align="left">microwave</td><td align="left">120</td><td align="left">1</td><td align="left">120</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99')
   SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay From renter JOIN booking_order USING (orderid) JOIN invoices USING (orderid) where checkoutdate-checkindate>2 GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate
   Select orderid,firstname,lastname,number_rating, houseid,description,email From reviews Join renter USING (renterid) JOIN Booking_order USING (orderid) WHERE number_rating< average_rating
   Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost FROM appliances HAVING timesrepaired>0 group by houseid,applianceid,appliancetype,repaircost,timesrepaired
   SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description From house Full Join amenities using (houseid) order by houseid;'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 18 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange113" id="rowrange113" onchange="rowRangeChange(this.value,113,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange113' id='rowrange113' onchange='rowRangeChange(this.value,113,"nonload")'>-->
          <option value="1 to 18">1 to 18</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange113').val(),113, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata113" id="displaydata113" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">HOUSEID</th><th align="left">DESCRIPTION</th><th align="left">LOCATION</th><th align="left">NUMBEROFBEDS</th><th align="left">NUMBEROFBATHS</th><th align="left">DESCRIPTION</th></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Private dock with 2 floors for boats and lounging</td></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Hot Tub</td></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Garage</td></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Back Patio</td></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Outdoor Fireplace</td></tr><tr><td align="left">111</td><td align="left">Southern Charm</td><td align="left">229 Cameron Loop</td><td align="left">6</td><td align="left">6</td><td align="left">Beverage Fridge</td></tr><tr><td align="left">112</td><td align="left">Big Bertha</td><td align="left">481 Esther Lane</td><td align="left">2</td><td align="left">8</td><td align="left">(null)</td></tr><tr><td align="left">113</td><td align="left">Southern Comfort</td><td align="left">10 Ski Lane</td><td align="left">9</td><td align="left">9</td><td align="left">Large Grill</td></tr><tr><td align="left">113</td><td align="left">Southern Comfort</td><td align="left">10 Ski Lane</td><td align="left">9</td><td align="left">9</td><td align="left">Speaker System</td></tr><tr><td align="left">113</td><td align="left">Southern Comfort</td><td align="left">10 Ski Lane</td><td align="left">9</td><td align="left">9</td><td align="left">Ping-Pong Table</td></tr><tr><td align="left">113</td><td align="left">Southern Comfort</td><td align="left">10 Ski Lane</td><td align="left">9</td><td align="left">9</td><td align="left">Ice Machine</td></tr><tr><td align="left">114</td><td align="left">Comfy Cabin</td><td align="left">100 Drive Lane</td><td align="left">4</td><td align="left">4</td><td align="left">(null)</td></tr><tr><td align="left">115</td><td align="left">Happy Hut</td><td align="left">614 Lake View Lane</td><td align="left">3</td><td align="left">1</td><td align="left">(null)</td></tr><tr><td align="left">116</td><td align="left">Hazel's House</td><td align="left">914 Nut Drive</td><td align="left">6</td><td align="left">5</td><td align="left">(null)</td></tr><tr><td align="left">117</td><td align="left">Pippa's Palace</td><td align="left">10 Popper Lane</td><td align="left">10</td><td align="left">12</td><td align="left">(null)</td></tr><tr><td align="left">118</td><td align="left">Millie's Manor</td><td align="left">150 Golden Drive</td><td align="left">6</td><td align="left">6</td><td align="left">(null)</td></tr><tr><td align="left">119</td><td align="left">Diamond Dock</td><td align="left">200 Ginger Street</td><td align="left">5</td><td align="left">6</td><td align="left">(null)</td></tr><tr><td align="left">120</td><td align="left">Mickey Mouse Clubhouse</td><td align="left">001 Daisy Drive</td><td align="left">8</td><td align="left">8</td><td align="left">(null)</td></tr></tbody></table></center></div>
              <script language="javascript">document.getElementById("sqltext").value = '-- Credit to project teammates Emma Kate Dygert, Murphy Heffernan, and Yixin Zhang --

-- Project Description in the Comments below --

-- First we create the database --

DROP TABLE reviews CASCADE CONSTRAINTS;
DROP TABLE renter CASCADE CONSTRAINTS;
DROP TABLE booking_order CASCADE CONSTRAINTS;
DROP TABLE house CASCADE CONSTRAINTS;
DROP TABLE host CASCADE CONSTRAINTS;
DROP TABLE invoices CASCADE CONSTRAINTS;
DROP TABLE appliances CASCADE CONSTRAINTS;
DROP TABLE task CASCADE CONSTRAINTS;
DROP TABLE clean_main_crews CASCADE CONSTRAINTS;
DROP TABLE amenities CASCADE CONSTRAINTS;

CREATE TABLE house
(houseid NUMBER(3) PRIMARY KEY,
Description VARCHAR2(50),
Location VARCHAR2(25),
Photos BLOB NULL,
Price NUMBER(6,2),
Numberofbeds NUMBER(2),
Numberofbaths NUMBER(2));

CREATE TABLE amenities
(amenityid NUMBER(5) PRIMARY KEY,
Description VARCHAR2(50),
HouseID NUMBER(3),
CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE appliances
(applianceid NUMBER(5) PRIMARY KEY,
Appliancetype VARCHAR2(15) NOT NULL,
Repaircost NUMBER(5,2) ,
Datepurchased DATE,
Timesrepaired NUMBER(2) NULL,
CostOfPurchase NUMBER(6,2),
CurrentlyBroken CHAR(1),
HouseID NUMBER(3),
CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE booking_order
(OrderID NUMBER(5) PRIMARY KEY,
DateBooked DATE,
CheckInDate DATE,
CheckOutDate DATE,
InvoiceNumber NUMBER(5),
HouseID NUMBER(3),
CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid));

CREATE TABLE renter
(RenterID NUMBER(5) PRIMARY KEY,
FirstName CHAR(30) NOT NULL,
LastName CHAR(30) NOT NULL,
Email VARCHAR2(30),
PhoneNumber NUMBER(10),
DateVisited DATE,
CostOfCleaning NUMBER(8),
NumberOfGuests NUMBER(2),
OrderID NUMBER(5),
CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE invoices
(InvoiceNumber NUMBER(5) PRIMARY KEY,
Total NUMBER(8,2),
Tax NUMBER(8,2),
GrandTotal NUMBER(8,2),
DateOfBilling DATE,
Description VARCHAR2(500),
OrderID NUMBER(5),
CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID));

CREATE TABLE clean_main_crews (
CrewID NUMBER(5) PRIMARY KEY,
Phone NUMBER(10),
Email VARCHAR2(30),
MaintenancePrice NUMBER(6),
MaintenanceName CHAR(30),
HouseID NUMBER(3),
CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID));


CREATE TABLE task
(TaskID NUMBER(5) PRIMARY KEY,
TaskDescription VARCHAR2(500),
ApplianceID NUMBER(5) NULL,
CrewID NUMBER(5),
CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID),
CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID));



CREATE TABLE reviews
(reviewid NUMBER(5) PRIMARY KEY,
Number_rating NUMBER(1),
Average_rating NUMBER(1),
Customer_name VARCHAR2(30),
Description VARCHAR2(500),
Date_posted DATE,
Title_phrase VARCHAR2(30),
Dateofstay DATE,
Customer_location VARCHAR2(30) NULL,
RenterID NUMBER(5),
CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid));

CREATE TABLE host
(HostName CHAR(30) PRIMARY KEY,
PhoneNumber NUMBER(10),
Email VARCHAR2(30));

-- Inserting House Data Values --

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) 
VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9);
 
INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6);

INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)
VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8);

-- Inserting Booking Order Data Values --

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113);

INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid)
VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118);

-- Inserting Appliances Data Values --

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112);

INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid)
VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112);



-- Inserting Amenities Data Values --

INSERT INTO amenities (amenityid, description, houseid)
VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (61429, 'Hot Tub', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76094, 'Speaker System', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (65432, 'Beverage Fridge', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (78901, 'Ice Machine', 113);


INSERT INTO amenities (amenityid, description, houseid)
VALUES (65123, 'Outdoor Fireplace', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (54637, 'Large Grill', 113);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (76290, 'Back Patio', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (82067, 'Garage', 111);

INSERT INTO amenities (amenityid, description, houseid)
VALUES (98075, 'Ping-Pong Table', 113);

-- Inserting Renter Data Values –

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346);


INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353);

INSERT INTO renter 
(RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID)
VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354);



-- Inserting Invoices Data Values --

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346);


INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349);
 
INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353);

INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid)
VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354);


-- Inserting Cleaning and Maintenance Crews Data Values --

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad');

 INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad');

INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename)
VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad');


-- Inserting Task Data Values --

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (33333, 'fridge deep clean', 56789, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (44444, 'change lightbulbs', 56790, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (55555, 'Dishwasher Cleaning', 56796, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (66666, 'Dryer Repair', 56790, 11111);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (77777, 'washer repair', 56791, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (88888, 'oven cleaning', 56792, 22222);

INSERT INTO task (taskid, taskdescription, applianceid, crewid)
VALUES (99999, 'freezer repair', 56795, 22222);








-- Inserting Reviews Data Values --

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114);

INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid)
VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115);

-- Inserting Host Data Values --

INSERT INTO host (hostname, phonenumber, email)
VALUES('john dygert', 6143238831,'john@johndygert.com');


INSERT INTO host (hostname, phonenumber, email)
VALUES('alison dygert', 6143234701,'alisondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com');

INSERT INTO host (hostname, phonenumber, email)
VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com');






--Querying to return results--




-- Uncollected amount percentage --

Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt, 
to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description IN ('not paid', 'partially paid')
group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description
order by to_char(total,'$999,999.99') desc;

-- Tracking of partial payment (Outer Join) --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
where description='partially paid'
order by to_char(total,'$999,999.99') desc;

-- Tracking of unpaid orders --

Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description
from invoices
Full Join booking_order using (orderID)
Join renter using (orderid)
Having description='not paid'
group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description
order by to_char(total,'$999,999.99') desc;

-- Estimate revenue for house 111 --

select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
GROUP BY HOUSEID
HAVING houseid=111;

-- Repair cost by order --

Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue
FROM clean_main_crews
Join appliances using (houseID)
FULL JOIN booking_order USING (houseID)
FULL JOIN INVOICES USING (invoiceNUMBER)
Where repaircost is NOT NULL
Group by booking_order.orderid,to_char(total,'999,999.99');

-- Renter staying more than 2 days --

SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay
From renter
JOIN booking_order USING (orderid)
JOIN invoices USING (orderid)
where checkoutdate-checkindate>2
GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate;

-- Unsatisfied Customers --

Select orderid,firstname,lastname,number_rating, houseid,description,email
From reviews
Join renter USING (renterid)
JOIN Booking_order USING (orderid)
WHERE number_rating< average_rating;

-- Appliances Repaired --

Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost
FROM appliances
HAVING timesrepaired>0
group by houseid,applianceid,appliancetype,repaircost,timesrepaired;

-- Amenities in Each House --

SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description
From house
Full Join amenities using (houseid)
order by houseid;

-- Appliance cost by order --

Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost
from appliances
JOIN booking_order USING (houseid)
group by orderid,houseid
order by to_char(sum(repaircost+costofpurchase),'$999,999.99');
DROP TABLE reviews CASCADE CONSTRAINTS
 DROP TABLE renter CASCADE CONSTRAINTS
 DROP TABLE booking_order CASCADE CONSTRAINTS
 DROP TABLE house CASCADE CONSTRAINTS
 DROP TABLE host CASCADE CONSTRAINTS
 DROP TABLE invoices CASCADE CONSTRAINTS
 DROP TABLE appliances CASCADE CONSTRAINTS
 DROP TABLE task CASCADE CONSTRAINTS
 DROP TABLE clean_main_crews CASCADE CONSTRAINTS
 DROP TABLE amenities CASCADE CONSTRAINTS
  CREATE TABLE house (houseid NUMBER(3) PRIMARY KEY, Description VARCHAR2(50), Location VARCHAR2(25), Photos BLOB NULL, Price NUMBER(6,2), Numberofbeds NUMBER(2), Numberofbaths NUMBER(2))
  CREATE TABLE amenities (amenityid NUMBER(5) PRIMARY KEY, Description VARCHAR2(50), HouseID NUMBER(3), CONSTRAINT amenities_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE appliances (applianceid NUMBER(5) PRIMARY KEY, Appliancetype VARCHAR2(15) NOT NULL, Repaircost NUMBER(5,2) , Datepurchased DATE, Timesrepaired NUMBER(2) NULL, CostOfPurchase NUMBER(6,2), CurrentlyBroken CHAR(1), HouseID NUMBER(3), CONSTRAINT appliances_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE booking_order (OrderID NUMBER(5) PRIMARY KEY, DateBooked DATE, CheckInDate DATE, CheckOutDate DATE, InvoiceNumber NUMBER(5), HouseID NUMBER(3), CONSTRAINT booking_order_houseid FOREIGN KEY (houseid) REFERENCES house(houseid))
  CREATE TABLE renter (RenterID NUMBER(5) PRIMARY KEY, FirstName CHAR(30) NOT NULL, LastName CHAR(30) NOT NULL, Email VARCHAR2(30), PhoneNumber NUMBER(10), DateVisited DATE, CostOfCleaning NUMBER(8), NumberOfGuests NUMBER(2), OrderID NUMBER(5), CONSTRAINT renter_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE invoices (InvoiceNumber NUMBER(5) PRIMARY KEY, Total NUMBER(8,2), Tax NUMBER(8,2), GrandTotal NUMBER(8,2), DateOfBilling DATE, Description VARCHAR2(500), OrderID NUMBER(5), CONSTRAINT invoices_OrderID FOREIGN KEY (orderid) REFERENCES booking_order(OrderID))
  CREATE TABLE clean_main_crews ( CrewID NUMBER(5) PRIMARY KEY, Phone NUMBER(10), Email VARCHAR2(30), MaintenancePrice NUMBER(6), MaintenanceName CHAR(30), HouseID NUMBER(3), CONSTRAINT clean_main_crews_HouseID FOREIGN KEY (houseid) REFERENCES house(HouseID))
   CREATE TABLE task (TaskID NUMBER(5) PRIMARY KEY, TaskDescription VARCHAR2(500), ApplianceID NUMBER(5) NULL, CrewID NUMBER(5), CONSTRAINT task_ApplianceID FOREIGN KEY (applianceID) REFERENCES appliances(ApplianceID), CONSTRAINT task_crewid FOREIGN KEY (crewid) REFERENCES clean_main_crews(CrewID))
    CREATE TABLE reviews (reviewid NUMBER(5) PRIMARY KEY, Number_rating NUMBER(1), Average_rating NUMBER(1), Customer_name VARCHAR2(30), Description VARCHAR2(500), Date_posted DATE, Title_phrase VARCHAR2(30), Dateofstay DATE, Customer_location VARCHAR2(30) NULL, RenterID NUMBER(5), CONSTRAINT reviews_renterid FOREIGN KEY (renterid) REFERENCES renter(renterid))
  CREATE TABLE host (HostName CHAR(30) PRIMARY KEY, PhoneNumber NUMBER(10), Email VARCHAR2(30))
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths)  VALUES (111,'Southern Charm', '229 Cameron Loop', NULL, 1000.00, 06, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (112, 'Big Bertha', '481 Esther Lane', NULL, 1249.99, 2, 8)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (113, 'Southern Comfort', '10 Ski Lane', NULL, 900, 9, 9)
   INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (114, 'Comfy Cabin', '100 Drive Lane', NULL, 500, 4, 4)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (115, 'Happy Hut', '614 Lake View Lane', NULL, 400, 3, 1)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (116, 'Hazel''s House', '914 Nut Drive', NULL, 750.11, 6, 5)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (117, 'Pippa''s Palace', '10 Popper Lane', NULL, 1500, 10, 12)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (118, 'Millie''s Manor', '150 Golden Drive', NULL, 1300, 6, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (119, 'Diamond Dock', '200 Ginger Street', NULL, 820, 5, 6)
  INSERT INTO house (houseid, description, location, photos, price, numberofbeds, numberofbaths) VALUES (120, 'Mickey Mouse Clubhouse', '001 Daisy Drive', NULL, 1000, 8, 8)
   INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12345, '01-Dec-2020', '20-May-2021', '27-May-2021', 54321, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12346, '17-Nov-2020', '4-Jun-2021', '6-Jun-2021', 54322, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12347, '18-Jan-2021', '11-Jun-2021', '13-Jun-2021', 54323, 116)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12348, '3-Mar-2021', '18-Jun-2021', '20-Jun-2021', 54324, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12349, '22-Oct-2020', '25-Jun-2021', '27-Jun-2021', 54325, 112)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12350, '14-Sep-2020', '2-Jul-2021', '4-Jul-2021', 54326, 118)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12351, '18-Feb-2021', '9-Jul-2021', '11-Jul-2021', 54327, 111)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12352, '4-Dec-2020', '16-Jul-2021', '18-Jul-2021', 54328, 114)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12353, '19-Nov-2020', '23-Jul-2021', '25-Jul-2021', 54329, 113)
  INSERT INTO booking_order (orderid, datebooked, checkindate, checkoutdate, invoicenumber, houseid) VALUES (12354, '30-Jan-2021', '30-Jul-2021', '2-Aug-2021', 54330, 118)
   INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56789, 'fridge', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56790, 'dryer', 200.00, '12-Mar-2021', 0, 900.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56791, 'washer', 250.00, '12-Mar-2021', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56792, 'oven', 400.00, '29-Jun-2019', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56793, 'toaster', 100.00, '20-Aug-2017', 2, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56794, 'microwave', 120.00, '01-Sep-2018', 1, 250.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56795, 'Freezer', 300.00, '31-Oct-2020', 1, 1000.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56796, 'dishwasher', 275.00, '05-Oct-2020', 0, 800.00, 'N', 111)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56797, 'coffee maker', 100.00, '17-Feb-2022', 0, 350.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56798, 'blender', 100.00, '17-Feb-2022', 0, 150.00, 'N', 112)
  INSERT INTO appliances (applianceid, appliancetype, repaircost, datepurchased, timesrepaired, costofpurchase, currentlybroken, houseid) VALUES (56799, 'Mixer', 110.00, '10-Feb-2022', 0, 225.00, 'N', 112)
     INSERT INTO amenities (amenityid, description, houseid) VALUES (31278, 'Private dock with 2 floors for boats and lounging', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (61429, 'Hot Tub', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76094, 'Speaker System', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (65432, 'Beverage Fridge', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (78901, 'Ice Machine', 113)
   INSERT INTO amenities (amenityid, description, houseid) VALUES (65123, 'Outdoor Fireplace', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (54637, 'Large Grill', 113)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (76290, 'Back Patio', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (82067, 'Garage', 111)
  INSERT INTO amenities (amenityid, description, houseid) VALUES (98075, 'Ping-Pong Table', 113)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11111,'emma', 'kate','emmadygert@gmail.com',6142902117, '20-May-2020',150,15,12345)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11112, 'hannah', 'bailey','hb@yahoo.com',6145675670, '04-JUN-2021',150,10,12346)
   INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11113,'lily','smith','smithle@gmail.com',6788003000,'11-JUN-2021',150,13,12347)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11114,'ava','miller','avamiller1@gmail.com',9087654444,'18-JUN-2021',150,15,12348)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11115,'julian','smith','julian01@yahoo.com',8790657854,'25-JUN-2021',150,12,12349)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11116,'sally','walter','waltersally@gmail.com',6541239000,'02-JUL-2021',150,8,12350)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11117,'thomas','train','choochoo@yahoo.com',8008003131,'09-JUL-2021',150,14,12351)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11118,'david','will','davidw@gmail.com',8764520980,'06-JUL-2021',150,17,12352)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11119,'andrew','diamond','diamond@gmail.com',6780000456,'23-JUL-2021',150,13,12353)
  INSERT INTO renter  (RenterID,FirstName,LastName,Email,PhoneNumber,DateVisited,Costofcleaning,NumberOfGuests,OrderID) VALUES (11120,'jill','mack','jillmack@yahoo.com',8007811654,'30-JUL-2021',150,7,12354)
     INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES (54321, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12345)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54322, 10099.00, 150.00, 10249.00, '01-June-2021', 'partially paid', 12346)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54323, 7150.00, 100.00, 7250.00, '01-June-2021', 'fully paid', 12347)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54324, 8000.00, 125.00, 8125.00, '01-July-2021', 'not paid', 12348)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54325, 11000.00, 150.00, 11150.00, '01-July-2021', 'partially paid', 12349)
   INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54326, 10000.00, 140.00, 10140.00, '01-July-2021', 'fully paid', 12350)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54327, 7500.00, 100.00, 7600.00, '10-July-2021', 'not paid', 12351)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54328, 8000.00, 125.00, 8125.00, '20-July-2021', 'partially paid', 12352)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54329, 7150.00, 100.00, 7250.00, '15-July-2021', 'fully paid', 12353)
  INSERT INTO invoices (InvoiceNumber, Total, Tax, GrandTotal, DateOfBilling, Description, orderid) VALUES(54330, 9000.00, 130.00, 9130.00, '15-July-2021', 'fully paid', 12354)
    INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (11111, 9001239876, 'janice@cleaning.com', 75.00, 111 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES  (22222, 9001239876, 'janice@cleaning.com', 75.00, 112, 'Janice Conrad')
   INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (33333, 9009876543, 'builder@building.com', 125.00, 113, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (44444, 9009876543, 'builder@building.com', 125.00, 114, 'Bob Builder')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (55555, 9001239876, 'janice@cleaning.com', 75.00, 115 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (66666, 9001239876, 'janice@cleaning.com', 75.00, 116 ,'Janice Conrad')
  INSERT INTO clean_main_crews (crewid, phone, email, maintenanceprice, houseid, maintenancename) VALUES (77777, 9001239876, 'janice@cleaning.com', 75.00, 117 ,'Janice Conrad')
    INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (33333, 'fridge deep clean', 56789, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (44444, 'change lightbulbs', 56790, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (55555, 'Dishwasher Cleaning', 56796, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (66666, 'Dryer Repair', 56790, 11111)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (77777, 'washer repair', 56791, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (88888, 'oven cleaning', 56792, 22222)
  INSERT INTO task (taskid, taskdescription, applianceid, crewid) VALUES (99999, 'freezer repair', 56795, 22222)
          INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54321, 5, 4.4, 'emma kate dygert', 'beautiful view!', '30-May-2021', 'great', '20-May-2021', 'Ohio', 11111)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54322, 4, 4.4, 'hannah bailey',  'a lot of fun!', '02-June-2021', 'fun', '27-May-2021', 'Kentucky', 11112)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54323, 5, 4.4,  'lily smith', 'excellent experience', '02-June-2021', 'excellent', '27-May-2021', 'Indiana', 11113)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54324, 3, 4.4, 'ava miller', 'could be better', '10-June-2021', 'unsatisfied', '02-June-2021', 'Ohio', 11114)
  INSERT INTO reviews (reviewid, number_rating, average_rating, customer_name, description, date_posted, title_phrase, dateofstay, customer_location, renterid) VALUES(54325, 5, 4.4, 'julian smith', 'was a great stay', '28-June-2021', 'great', '15-June-2021', 'Tennessee', 11115)
   INSERT INTO host (hostname, phonenumber, email) VALUES('john dygert', 6143238831,'john@johndygert.com')
   INSERT INTO host (hostname, phonenumber, email) VALUES('alison dygert', 6143234701,'alisondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('emma kate dygert', 6142902117,'emmadygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('jackson dygert', 6147609422,'jacksondygert@gmail.com')
  INSERT INTO host (hostname, phonenumber, email) VALUES('hayden dygert', 6144301717,'haydendygert@gmail.com')
            Select firstname,lastname,email,orderid,description,to_char(total,'$999,999.99') as TotalAmt,  to_char(100*sum(total)/(select sum(total) from invoices),'99.99') as percentofTotalAmt from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description IN ('not paid', 'partially paid') group by firstname,lastname,email,orderid, to_char(total,'$999,999.99'),description order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) where description='partially paid' order by to_char(total,'$999,999.99') desc
   Select firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99') as TotalAmt,checkindate,checkoutdate,(select to_char(sum(total),'$999,999.99') from invoices where description='not paid' ) as TotalunpaidAmt,description from invoices Full Join booking_order using (orderID) Join renter using (orderid) Having description='not paid' group by firstname,lastname,email,invoices.invoicenumber, orderid,houseid,to_char(total,'$999,999.99'),checkindate,checkoutdate,description order by to_char(total,'$999,999.99') desc
   select TO_CHAR(sum(total-maintenanceprice-repaircost),'$999,999.99') AS ESTREVENUE ,houseid FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) GROUP BY HOUSEID HAVING houseid=111
   Select booking_order.orderid,to_char(sum(repaircost),'$999,999.99')repaircost,to_char(total,'999,999.99') totalrevenue FROM clean_main_crews Join appliances using (houseID) FULL JOIN booking_order USING (houseID) FULL JOIN INVOICES USING (invoiceNUMBER) Where repaircost is NOT NULL Group by booking_order.orderid,to_char(total,'999,999.99')
   SELECT orderid, firstname,lastname,email,checkindate,checkoutdate,(select sum(checkoutdate-checkindate) from booking_order WHERE checkoutdate-checkindate>2) TotalDays, sum(checkoutdate-checkindate) DaysStay From renter JOIN booking_order USING (orderid) JOIN invoices USING (orderid) where checkoutdate-checkindate>2 GROUP BY ORDERID,firstname,lastname,email,checkindate,checkoutdate
   Select orderid,firstname,lastname,number_rating, houseid,description,email From reviews Join renter USING (renterid) JOIN Booking_order USING (orderid) WHERE number_rating< average_rating
   Select houseid,applianceid,appliancetype, repaircost,timesrepaired,sum(repaircost*timesrepaired) as totalrepaircost FROM appliances HAVING timesrepaired>0 group by houseid,applianceid,appliancetype,repaircost,timesrepaired
   SELECT houseid,house.description, location, numberofbeds,numberofbaths,amenities.description From house Full Join amenities using (houseid) order by houseid
   Select orderid, houseid,to_char(sum(repaircost+costofpurchase),'$999,999.99') as totalcost from appliances JOIN booking_order USING (houseid) group by orderid,houseid order by to_char(sum(repaircost+costofpurchase),'$999,999.99');'</script>
  <br><table border="0" width="90%"><tbody><tr><th colspan="1" align="left">Query returned: 4 row(s)<form action="https://sqlweb.fsb.miamioh.edu/viewcsv.php" method="post"><input type="hidden" name="numOfQry" value="115"><input type="submit" value="Download CSV"></form></th>  
      <th align="right"><select name="rowrange114" id="rowrange114" onchange="rowRangeChange(this.value,114,&quot;nonload&quot;)">";
              <!--	<th align='right'><select name='rowrange114' id='rowrange114' onchange='rowRangeChange(this.value,114,"nonload")'>-->
          <option value="1 to 4">1 to 4</option></select></th></tr></tbody></table><p>              <script language="JavaScript">
                  rowRangeChange($('#rowrange114').val(),114, "nonload");
              </script>
              </p><div name="displayloading" id="displayloading" bis_skin_checked="1"></div>
              <br>
              <div name="displaydata114" id="displaydata114" bis_skin_checked="1"><center><table id="tabledataview" align="center"><tbody><tr><th align="left">ORDERID</th><th align="left">HOUSEID</th><th align="left">TOTALCOST</th></tr><tr><td align="left">12349</td><td align="left">112</td><td align="left">   $1,035.00</td></tr><tr><td align="left">12346</td><td align="left">111</td><td align="left">   $7,945.00</td></tr><tr><td align="left">12351</td><td align="left">111</td><td align="left">   $7,945.00</td></tr><tr><td align="left">12345</td><td align="left">111</td><td align="left">   $7,945.00</td></tr></tbody></table></center></div>
          </div>
<br> &nbsp;


</body></html>